---
title: traefik
date: 2021-12-28 00:00:00 +01:00
header:
  teaser: "/assets/images/academy/traefik.svg"
  image: "/assets/images/academy/traefik.svg"
categories:
- academy
tags:
- academy
- sre
excerpt: "Notes about traefik."
---

Notes about traefik.

# Introduction

Traefik is an Edge Router, it means that it's the door to your platform, and that it intercepts and routes every incoming request

## Auto Service Discovery

Where traditionally edge routers (or reverse proxies) need a configuration file that contains every possible route to your services, Traefik gets them from the services themselves.

Deploying your services, you attach information that tells Traefik the characteristics of the requests the services can handle.

It means that when a service is deployed, Traefik detects it immediately and updates the routing rules in real time. The opposite is true: when you remove a service from your infrastructure, the route will disappear accordingly.

You no longer need to create and synchronize configuration files cluttered with IP addresses or other rules.

Traefik is able to use your cluster API to discover the services and read the attached information. In Traefik, these connectors are called providers because they provide the configuration to Traefik.


run `curl http://localhost:8080/api/rawdata | jq`  to see Traefik's API rawdata


```yml
# Docker configuration backend
providers:
  docker:
    defaultRule: "Host(`{{ trimPrefix `/` .Name }}.docker.localhost`)"

# API and dashboard configuration
api:
  insecure: true
```

For services with more than a port exposed, the label `traefik.http.services.{{ container }}.loadbalancer.server.port=80` should be used.


curl -H Host:pihole.docker.localhost http://127.0.0.1

docker.internal.bandonga.com

b.dev


address=/router.internal.bandonga.com/192.168.1.1
address=/docker.internal.bandonga.com/192.168.1.112
address=/nuc.internal.bandonga.com/192.168.1.114
address=/nuc-amt.internal.bandonga.com/192.168.1.199

address=/router.b.dev/192.168.1.1
address=/d.dev/192.168.1.112
address=/pve.b.dev/192.168.1.114
address=/nuc-amt.b.dev/192.168.1.199
