---
title: "Kamailio: Data Structures"
excerpt: "Notes about kamailio"
permalink: /kamailio/vars/
header:
  image: "/assets/images/academy/kamailio.svg"
last_modified_at: 2023-03-17 21:00:00 +00:00
toc: true
---

# Introduction

> :warning: **Note:** Read the [offical docs](https://www.kamailio.org/wikidocs/cookbooks/devel/core/) to get the most updated information.

## Data Structures

### Variables

The variables start with `$` character. Also called a Pseudo-variable because some are:
 * read-only
 * hold multiple values
 * a reference for a sip message
 * stored in private or shared memory
 * can be represented as `$class | $class(key) | $(class(key)) | $(class(name)[index])`

**Classes:** Majority of varaibles are in module `pv` and read-only (such as `$(hdr(name)[N])`  content of the headers), with the exceptions:
  * `$var(name)` - private variable: This kind of variables are faster, being referenced directly to memory location.
  * `$shv(name)` - shared value variable
  * `$avp(x) | $xavp` - Unordered List Attribute-Value Pair 
  * `$sht(hash=>name)` - shared table variable
  * and some sip message attributes
    * `$br` - request's first branch
    * `$bf` - branch flags of branch 0 (RURI) - decimal output
    * `$bF` - branch flags of branch 0 (RURI) - hexa output
    * `$du` - destination uri
    * `$fd` - domain in URI of 'From' header
    * `$fn` - display name of 'From' header
    * `$fs` - the forced send socket for the SIP message
    * `$fu` - URI of 'From' header
    * `$fU` - username in URI of 'From' header
    * `$mf` - message/transaction flags set for current SIP request
    * `$mF` - message/transaction flags set for current SIP request in hexa-decimal
    * `$rd` - domain in request's URI (without port)
    * `$rp` - port of R-URI
    * `$ru` - request's URI 
    * `$rU` - username in request's URI 
    * `$td` - domain in URI of 'To' header
    * `$tn` - display name of 'To' header
    * `$tu` - URI of 'To' header
    * `$tU` - username in URI of 'To' header

**Private memory:** no reloading, one copy per process
* `$ru $rU $rd` and other sip message attributes
* `$(hdr(name)[N])`
* `$var(name)`

**Shared memory:** I you need to use a variable in a request and response, a shared variable should be used. The sip message is processed in private memory and moved to shared memory when when a transaction is created.
  * `$shv(name)` - shared value variable
  * `$avp(x) | $xavp` - Unordered List Attribute-Value Pair 
  * `$sht(hash=>name)` - shared table variable

Type of values:
  * `integer` signed 32 bit. A boolean is represented by an integer restricted to 0 (alias `false, off, no`), 1 (alias `true, on, yes`).
  * `string` an alphanumeric tokens in `"double"` or `'single'` quotes (can be split in manny tokens `"abc" "def"`)
  * `ID` an aphphanumeric special token not enclosed in quotes.
  * `network attribute` an address `1.1.1.1`, `1.1.1.1/32`, ipv4 or ipv6.


##### var

`$var(name)` - Very fast variable with single value stored in private memory (each process has its own value)
* Initial value is 0
* Can be initialized to another value using modparam of pv module
* Assignment to `$null` sets it to 0 (variant `$vn(name)` can hold `$null` value

```c
#!KAMAILIO

loadmodule "xlog"
loadmodule "pv"
loadmodule "sl"

request_route {
    $var(name) = "Hello, World!";

    xlog("$$var(name): $var(name)\n");
    sl_send_reply(200, "OK $var(name)");
}

```

##### resources
* [Wiki Pseudo-Variables Cookbook](https://www.kamailio.org/wikidocs/cookbooks/devel/pseudovariables/)
* [Wiki Core Cookbook](https://www.kamailio.org/wikidocs/cookbooks/devel/core/)
